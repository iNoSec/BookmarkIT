<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>SDDL Security Descriptor Language</title>
</head><body><b><u>Deciphering the security descriptor</u></b><br/>
<br/>
The security descriptor, as displayed by <b><i>sc sdshow,</i></b>is formatted according the Security Descriptor Definition<br/>
Language (SDDL).<br/>
<br/>
The descriptor will usually be divided into two parts:<br/>
<ul><li>Prefix of <b>S:</b>– System Access Control List (SACL),controls auditing (not covered in this post) </li>
<li>Prefix of <b>D:</b>– Discretionary ACL (DACL),controls permissions</li>
</ul>
<br/>
<a href="http://msmvps.com/blogs/erikr/WindowsLiveWriter/SetpermissionsonaspecificserviceWindows_CC90/image_1.png"><img height="21" src="http://msmvps.com/blogs/erikr/WindowsLiveWriter/SetpermissionsonaspecificserviceWindows_CC90/image_thumb_1.png" width="240"/></a><br/>
Each section, inside the parenthesis, represent a specific entry (security/auditing).<br/>
Inside the parenthesis, the user account and the correct permissions are specified. <br/>
<br/>
Each string can be evaluated by applying the following:<br/>
<b>(Allow/Deny;;String of permissions;;;SID or acronym for built-in account or group)</b><br/>
<br/>
<b>(A;;CCLCSWLOCRRC;;;AU)</b><br/>
<br/>
The first letter represents Allow (A) the opposite of Deny which would be represented by a (D).<br/>
Each pair of letters represents a specific permission:<br/>
CC – 	SERVICE_QUERY_CONFIG – 			ask the SCM for the service’s current configuration<br/>
LC – 	SERVICE_QUERY_STATUS – 			ask the SCM for the service’s current status<br/>
SW – 	SERVICE_ENUMERATE_DEPENDENTS – 	list dependent services<br/>
LO – 	SERVICE_INTERROGATE – 			ask the service its current status<br/>
CR – 	SERVICE_USER_DEFINED_CONTROL – 	send a service control defined by the service’s authors<br/>
RC – 	READ_CONTROL – 					read the security descriptor on this service.<br/>
<br/>
Additional permissions:<br/>
RP – 	SERVICE_START – 					start the service<br/>
WP – 	SERVICE_STOP – 					stop the service<br/>
DT – 	SERVICE_PAUSE_CONTINUE – 		pause / continue the service<br/>
WD –	Modify							WDac<br/>
<br/>
The last two letters define the security principal assigned with these permissions (a SID or well known. See child page for aliases<br/>
<br/>
<br/>
<br/>
Lets look at another example:<br/>
<b>(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)</b><br/>
<br/>
A – Allow<br/>
CC – SERVICE_QUERY_CONFIG – ask the SCM for the service’s current configuration<br/>
DC – Delete All Child Objects<br/>
LC – SERVICE_QUERY_STATUS – ask the SCM for the service’s current status<br/>
SW – SERVICE_ENUMERATE_DEPENDENTS – list dependent services<br/>
RP – Read all properites<br/>
WP – SERVICE_STOP – stop the service<br/>
DT – SERVICE_PAUSE_CONTINUE – pause / continue the service<br/>
LO – SERVICE_INTERROGATE – ask the service its current status<br/>
CR – SERVICE_USER_DEFINED_CONTROL – send a service control defined by the service’s authors<br/>
SD – Delete<br/>
RC – READ_CONTROL – read the security descriptor on this service.<br/>
WD – Modify permissions<br/>
WO – Modify owner<br/>
BA- Built-in administrators<br/>
</body></html>