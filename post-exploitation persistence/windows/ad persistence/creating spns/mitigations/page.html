<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Mitigations</title>
</head><body>Mitigation &amp; Detection<br/>
<br/>
Kerberoast mitigation is simple: use long, complex passwords (&gt;30 characters) for all service accounts or preferably, use Managed Service Accounts. If an attacker is using this technique to persist, changing service account passwords at least once a year to something long &amp; complex will help mitigate.<br/>
<br/>
With PowerShell, it’s trivial to get a list of domain/forest user accounts that have an associated SPN.<br/>
PowerShell AD module: get-aduser -filter {serviceprincipalname -like “*”} -prop serviceprincipalname<br/>
<br/>
If you are logging PowerShell activity and sending that data into a SIEM/Splunk, set an alert for “KerberosRequestorSecurityToken”.<br/>
<br/>
Hopefully, the environment is mature enough where these accounts should be in a specific OU (or within a specific OU). If all service accounts are in a designated location and new ones are found outside of this location, then that’s something that can be monitored.<br/>
<br/>
Every environment should be checking for old service accounts (AD accounts with SPNs) and at least removing the SPNs when no longer needed.<br/>
<br/>
Too often I visit a customer and find the default domain admin account has a service principal name associated with it. Not only does this mean that this account is probably running as a service on a regular server, but that the default domain admin account could be Kerberoasted to gain knowledge of its password and own the domain.<br/>
<br/>
NOTE:<br/>
A Service Principal Name should only be added to an account when an application requires it. When that service account is no longer needed and the application has been taken out of service, the SPN needs to be removed from the service account and the service account disabled.<br/>
Don’t add a SPN to an admin account, create a new account with the appropriate rights to be the service account.<br/>
Never add a SPN to a default Administrator account or “break-glass” account meant to only be used when other accounts won’t work.<br/>
<br/>
Some organizations delegate the ability to modify the ServicePrincipalName attribute on accounts, this should be carefully monitored and controlled.</body></html>