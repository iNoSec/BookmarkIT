<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Started With Stuxnet</title>
</head><body>The Stuxnet Worm embedded 4 different 0-days, one was vulnerability MS10-061 in Windows Printer Spooler.<br/>
Basically, this vulnerability permits to remotely execute code with SYSTEM privilege on a Windows XP machine if a printer is shared on the network. It was patched by Microsoft on September 2010. The other versions of Windows are vulnerable, but only when really particular conditions are met<br/>
<br/>
<img src="image.png"/><br/>
<br/>
Actually, when a printer is shared on the network on Windows XP, it's reachable by anybody as the Guest user in order to print documents. The &quot;printer spooler service&quot; which is locally responsible for handling the requests from the client is the spoolsv.exe process. It's possible to remotely talk with it by using the RPC protocol (Remote Procedure Call). Stuxnet simply uses the methods implemented by the service to ask it to write a file on the disk of the machine. <br/>
<br/>
This auto-compilation feature was used by Stuxnet: 2 files were uploaded on the targeted remote machine using MS10-061:<br/>
%SystemRoot%\System32\winsta.exe: Stuxnetâ€™s main module<br/>
%SystemRoot%\System32\wbem\mof\sysnullevnt.mof: MOF file that will automatically compile itself and that contains the code needed to execute the winsta.exe file when some events occur.</body></html>