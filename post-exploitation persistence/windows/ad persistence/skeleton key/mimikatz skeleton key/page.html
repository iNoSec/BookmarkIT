<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Mimikatz Skeleton Key</title>
</head><body>Note that the behavior documented in this post was observed in a lab environment using the version of Mimikatz shown in the screenshot. There are likely differences in the Skeleton Key malware documented by Dell SecureWorks and the Mimikatz skeleton key functionality. Mimikatz effectively “patches” LSASS to enable use of a master password with any valid domain user. Rebooting the DC refreshes the memory which removes the “patch”.<br/>
Implanting the Mimikatz Skeleton Key on one or multiple Domain Controllers:<br/>
<br/>
Mimikatz can now inject a skeleton key into LSASS on the Domain Controller by running the following command on the DC:<br/>
  mimikatz.exe “privilege::debug” “misc::skeleton” exit<br/>
<br/>
<img src="image.png"/><br/>
<br/>
When there are multiple Domain Controllers in an Active Directory site, <b>all of them need the Skeleton Key</b>implant to ensure the skeleton key master password is accepted as the user’s valid password.. Since the client discovers a Domain Controller using DCLocator, the DC the client selects is effectively random. If all the DCs don’t have skeleton key configured, the master password won’t work when the client authenticates to a DC without skeleton key.<br/>
<br/>
Authenticating with the Mimikatz Skeleton Key:<br/>
<br/>
Testing user password and user account with skeleton key password.<br/>
Note that both passwords are accepted – the valid user password and the skeleton key master password!<br/>
<br/>
<img src="image 2.png"/><br/>
<br/>
Testing Domain Admin account with password &amp; skeleton key password.<br/>
Note that both passwords are accepted – the valid user password and the skeleton key master password!<b><br/>
</b><b><br/>
</b><img src="image 3.png"/></body></html>