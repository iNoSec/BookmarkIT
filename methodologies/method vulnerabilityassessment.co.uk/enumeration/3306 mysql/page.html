<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>3306: MySQL</title>
</head><body><ul><li><span style="font-size: 16pt">MySQL port 3306 open</span></li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">Enumeration</span></li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">nmap -A -n -p3306 &lt;IP Address&gt;</span></li>
<li><span style="font-size: 16pt">nmap -A -n -PN --script:ALL -p3306 &lt;IP Address&gt;</span></li>
<li><span style="font-size: 16pt">telnet IP_Address 3306</span></li>
<li><span style="font-size: 16pt">use test; select * from test;</span></li>
<li><span style="font-size: 16pt">To check for other DB's -- show databases</span></li>
</ul>
</li>
<li><span style="font-size: 16pt">Administration</span></li>
<li style="list-style-type: none"><ul><li><a href="http://www.securiteam.com/tools/6Y00L0U5PC.html"><span style="font-size: 16pt">MySQL Network Scanner</span></a><span style="font-size: 16pt"> <a href="http://www.securiteam.com/tools/6Y00L0U5PC.html"><img src="image.png"/></a></span></li>
<li><a href="http://dev.mysql.com/downloads/gui-tools/5.0.html"><span style="font-size: 16pt">MySQL GUI Tools</span></a><span style="font-size: 16pt"> <a href="http://dev.mysql.com/downloads/gui-tools/5.0.html"><img src="image 2.png"/></a></span></li>
<li><span style="font-size: 16pt">mysqlshow</span></li>
<li><span style="font-size: 16pt">mysqlbinlog</span></li>
</ul>
</li>
<li>Manual Checks</li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">Default usernames and passwords</span></li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">username: root password:</span></li>
<li><span style="font-size: 16pt">testing</span></li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">mysql -h &lt;Hostname&gt; -u root</span></li>
<li><span style="font-size: 16pt">mysql -h &lt;Hostname&gt; -u root</span></li>
<li><span style="font-size: 16pt">mysql -h &lt;Hostname&gt; -u root@localhost</span></li>
<li><span style="font-size: 16pt">mysql -h &lt;Hostname&gt;</span></li>
<li><span style="font-size: 16pt">mysql -h &lt;Hostname&gt; -u &quot;&quot;@localhost</span></li>
</ul>
</li>
</ul>
</li>
<li><span style="font-size: 16pt">Configuration Files</span></li>
<li style="list-style-type: none"><ul><li>Operating System</li>
<li style="list-style-type: none"><ul><li>windows</li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">config.ini</span></li>
<li><span style="font-size: 16pt">my.ini</span></li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">windows\my.ini</span></li>
<li><span style="font-size: 16pt">winnt\my.ini</span></li>
</ul>
</li>
<li>&lt;InstDir&gt;/mysql/data/</li>
</ul>
</li>
<li>unix</li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">my.cnf</span></li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">/etc/my.cnf</span></li>
<li><span style="font-size: 16pt">/etc/mysql/my.cnf</span></li>
<li><span style="font-size: 16pt">/var/lib/mysql/my.cnf</span></li>
<li><span style="font-size: 16pt">~/.my.cnf</span></li>
<li><span style="font-size: 16pt">/etc/my.cnf</span></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><span style="font-size: 16pt">Command History</span></li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">~/.mysql.history</span></li>
</ul>
</li>
<li><span style="font-size: 16pt">Log Files</span></li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">connections.log</span></li>
<li><span style="font-size: 16pt">update.log</span></li>
<li><span style="font-size: 16pt">common.log</span></li>
</ul>
</li>
<li><span style="font-size: 16pt">To run many sql commands at once -- mysql -u username -p &lt; manycommands.sql</span></li>
<li><span style="font-size: 16pt">MySQL data directory (Location specified in my.cnf)</span></li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">Parent dir = data directory</span></li>
<li><span style="font-size: 16pt">mysql</span></li>
<li><span style="font-size: 16pt">test</span></li>
<li><span style="font-size: 16pt">information_schema (Key information in MySQL)</span></li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">Complete table list -- select table_schema,table_name from tables;</span></li>
<li><span style="font-size: 16pt">Exact privileges -- select grantee, table_schema, privilege_type FROM schema_privileges;</span></li>
<li><span style="font-size: 16pt">File privileges -- select user,file_priv from mysql.user where user='root';</span></li>
<li><span style="font-size: 16pt">Version -- select version();</span></li>
<li><span style="font-size: 16pt">Load a specific file -- SELECT LOAD_FILE('FILENAME');</span></li>
</ul>
</li>
</ul>
</li>
<li><span style="font-size: 16pt">SSL Check</span></li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">mysql&gt; show variables like 'have_openssl';</span></li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">If there's no rows returned at all it means the the distro itself doesn't support SSL connections and probably needs to be recompiled. If its disabled it means that the service just wasn't started with ssl and can be easily fixed.</span></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><span style="font-size: 16pt">Privilege Escalation</span></li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">Current Level of access</span></li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">mysql&gt;select user();</span></li>
<li><span style="font-size: 16pt">mysql&gt;select user,password,create_priv,insert_priv,update_priv,alter_priv,delete_priv,drop_priv from user where user='OUTPUT OF select user()';</span></li>
</ul>
</li>
<li><span style="font-size: 16pt">Access passwords</span></li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">mysql&gt; use mysql</span></li>
<li><span style="font-size: 16pt">mysql&gt; select user,password from user;</span></li>
</ul>
</li>
<li><span style="font-size: 16pt">Create a new user and grant him privileges</span></li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">mysql&gt;create user test identified by 'test';</span></li>
<li><span style="font-size: 16pt">mysql&gt; grant SELECT,CREATE,DROP,UPDATE,DELETE,INSERT on *.* to mysql identified by 'mysql' WITH GRANT OPTION;</span></li>
</ul>
</li>
<li><span style="font-size: 16pt">Break into a shell</span></li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">mysql&gt; \! cat /etc/passwd</span></li>
<li><span style="font-size: 16pt">mysql&gt; \! bash</span></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><span style="font-size: 16pt">SQL injection</span></li>
<li style="list-style-type: none"><ul><li><a href="http://packetstormsecurity.org/UNIX/audit/mysql-miner.pl">mysql-miner.pl</a> <a href="http://packetstormsecurity.org/UNIX/audit/mysql-miner.pl"><img src="image 3.png"/></a></li>
<li style="list-style-type: none"><ul><li>mysql-miner.pl http://target/ expected_string database</li>
</ul>
</li>
<li><span style="font-size: 16pt">http://www.imperva.com/resources/adc/sql_injection_signatures_evasion.html</span></li>
<li><span style="font-size: 16pt">http://www.justinshattuck.com/2007/01/18/mysql-injection-cheat-sheet/</span></li>
</ul>
</li>
<li>References.</li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">Design Weaknesses</span></li>
<li style="list-style-type: none"><ul><li><span style="font-size: 16pt">MySQL running as root</span></li>
<li><span style="font-size: 16pt">Exposed publicly on Internet</span></li>
</ul>
</li>
<li>http://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=mysql</li>
<li>http://search.securityfocus.com/swsearch?sbm=%2F&amp;metaname=alldoc&amp;query=mysql&amp;x=0&amp;y=0</li>
</ul>
</li>
</ul>
</li>
</ul>
</body></html>