<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Get Domain Users (GDU)</title>
</head><body>#################################################################<br/>
# GET DOMIAIN USERS (GDU) - Overview<br/>
#################################################################<br/>
Script Name: Get Domain Users (GDU)<br/>
Author: Scott Sutherland(nullbind)&lt;scott.sutherland@netspi.com&gt;<br/>
Version: 1.1<br/>
<br/>
Description:<br/>
This script is intended to automate Windows domain user <br/>
enumeration using multiple methods, and initiate a <br/>
dictionary attack against the accounts with respect to the <br/>
acccount lockout policy.<br/>
<br/>
Technical Summary:<br/>
1) Determine domain from IPCONFIG (option provided to override)<br/>
2) Identify domain controllers via DNS server queries<br/>
3) Enumerate users via RCP endpoints with Dumpsec<br/>
4) Enumerate users via RCP endpoints with Enum<br/>
5) Enumerate users via RCP SID Brute forcing with the Metasploit<br/>
  smb_lookupsid module<br/>
6) Enumerate users via SNMP default strings with the Metasploit<br/>
  snmp_enumusers module<br/>
7) Enumerate password policy with Dumpsec<br/>
8) Conduct dictionary attack using top 20 rockyou password list <br/>
  against enumerated users with Metasploit smb_login module <br/>
  with respect to the password policy<br/>
		<br/>
Authentication Methods:<br/>
Users can authenticate with one of three options during attack.<br/>
1) Null SMB Login<br/>
2) Trusted connection<br/>
3) Username and password<br/>
<br/>
Notes:<br/>
1) If no lockout policy exists, the dictionary attack will be <br/>
  aborted so it can be manually confirmed.<br/>
2)If the lockout policy cannot be determined the dicitonary<br/>
  attack will be aborted.<br/>
<br/>
#################################################################<br/>
# GET DOMIAIN USERS (GDU) - Installation<br/>
#################################################################<br/>
<br/>
1) Download GDU.bat<br/>
<br/>
2) Download the freeware tools below<br/>
<br/>
		Joeware Tools<br/>
		http://www.joeware.net/freetools/<br/>
		Download the tools below:<br/>
		- NetSess.exe <br/>
		- adfind.exe 		<br/>
<br/>
		UnxUtils<br/>
		Source - http://sourceforge.net/projects/unxutils/<br/>
		I recommend downloading the endtire toolset, but<br/>
		at a minimum you'll need the files below:<br/>
		- grep.exe <br/>
		- gawk.exe <br/>
		- uniq.exe<br/>
		- tail.exe<br/>
		- head.exe<br/>
		- sort.exe<br/>
		- tr.exe<br/>
		<br/>
		Dumpssec<br/>
		http://www.systemtools.com/somarsoft/?somarsoft.com<br/>
		<br/>
		Metasploit<br/>
		http://www.metasploit.com<br/>
		<br/>
		Enum<br/>
		http://www.google.com<br/>
<br/>
3) Add the new freeware program directories to the executable PATH.<br/>
<br/>
4) Modify the dumpsec, enum, and metasploit paths in GDU.bat.<br/>
<br/>
5) Modify/add passwords to script.<br/>
<br/>
6) Execute script.<br/>
<br/>
################################################################<br/>
# GET DOMIAIN USERS (GDU) - Usage<br/>
################################################################<br/>
<br/>
 Syntax: gdu [options]<br/>
<br/>
 Options:<br/>
<br/>
  -n Authenticate with a null SMB login<br/>
  -t Authenticate with a trusted connection (current user)<br/>
  -a Authenticate with a supplied credentials<br/>
  -u User name to authenticate with<br/>
  -p Password to authenticate with<br/>
  -g Domain group name for finding active member sessions<br/>
  -c custom domain<br/>
<br/>
 Examples (basic):<br/>
<br/>
  gdu -n 							<br/>
  gdu -t<br/>
  gdu -a -u &quot;domain\user&quot; -p password<br/>
  gdu -g &quot;group name&quot; -u &quot;domain\user&quot; -p password <br/>
<br/>
 Examples (custom domain):<br/>
<br/>
  gdu -n -c domain.com							<br/>
  gdu -t -c domain.com<br/>
  gdu -a -u &quot;domain\user&quot; -p password -c domain.com<br/>
  gdu -g &quot;group name&quot; -u &quot;domain\user&quot; -p password -c domain.com<br/>
<br/>
################################################################<br/>
# GET DOMIAIN USERS (GDU) - Todo<br/>
################################################################<br/>
 <br/>
1) Add fast/comprehensive modes - fast=stop user enumeration on first success.<br/>
2) Add custom dictionary option.<br/>
3) Add check for required executables before running.<br/>
4) Add some more error checking.<br/>
5) Write the script in a real programming lanugage . - Maybe ruby... :)</body></html>