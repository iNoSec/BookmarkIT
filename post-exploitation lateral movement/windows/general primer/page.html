<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>General Primer</title>
</head><body>Remote Movement:<br/>
<br/>
1) psexec<br/>
<br/>
 The tried and true method for lateral movement on windows. You can use<br/>
 psexec [1], winexe [2], metasploit's psexec_psh [3], Powershell Empire's<br/>
 invoke_psexec [4], or the builtin windows command &quot;sc&quot; [5]. For the<br/>
 metasploit module, powershell empire, and pth-winexe [6], you just need the<br/>
 hash, not the password. It's the most universal method (it works on any<br/>
 windows computer with port 445 open), but it's also the least stealthy.<br/>
 Event type 7045 &quot;Service Control Manager&quot; will appear in the event logs. In<br/>
 my experience, no one has ever noticed during a hack, but it helps the<br/>
 investigators piece together what the hacker did afterwards.<br/>
<br/>
2) WMI<br/>
<br/>
 The most stealthy method. The WMI service is enabled on all windows<br/>
 computers, but except for servers, the firewall blocks it by default. You<br/>
 can use wmiexec.py [7], pth-wmis [6] (here's a demonstration of wmiexec and<br/>
 pth-wmis [8]), Powershell Empire's invoke_wmi [9], or the windows builtin<br/>
 wmic [5]. All except wmic just need the hash.<br/>
<br/>
3) PSRemoting [10]<br/>
<br/>
 It's disabled by default, and I don't recommend enabling new protocols.<br/>
 But, if the sysadmin has already enabled it, it's very convenient,<br/>
 especially if you use powershell for everything (and you should use<br/>
 powershell for almost everything, it will change [11] with powershell 5 and<br/>
 windows 10, but for now powershell makes it easy to do everything in RAM,<br/>
 avoid AV, and leave a small footprint)<br/>
<br/>
4) Scheduled Tasks<br/>
<br/>
 You can execute remote programs with at and schtasks [5]. It works in the<br/>
 same situations where you could use psexec, and it also leaves a well known<br/>
 footprint [12].<br/>
<br/>
5) GPO<br/>
<br/>
 If all those protocols are disabled or blocked by the firewall, once you're<br/>
 Domain Admin, you can use GPO to give users a login script, install an msi,<br/>
 execute a scheduled task [13], or, like we'll see with the computer of<br/>
 Mauro Romeo (one of Hacking Team's sysadmins), use GPO to enable WMI and<br/>
 open the firewall.<br/>
<br/>
<br/>
</body></html>