<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>SyncAppvPublishingService</title>
</head><body>PowerShell cmdlet for App Virtualization Publishing<br/>
	Also comes with .VBS and .EXE helpers<br/>
	Signed, default vbs script in Windows 10<br/>
	It is portable!, so you can move it to Win 7/others. It requires .NET 4 and PSv3<ul><li style="list-style-type: none">Located in C:\Windows\System32\SyncAppVPublishing[Server|Service].vbs</li>
</ul>
<br/>
Helpers are provided to make it easier to call PowerShell cmdlet from outside PowerShell<br/>
	Take args from cmdline<br/>
	Format received data<br/>
	Pass it to PowerShell module<br/>
<img src="image.png"/><br/>
<img src="image 2.png"/><br/>
<img src="image 3.png"/><br/>
<br/>
It builds both the PowerShell code and command as strings without escaping the arguments<br/>
Raw PowerShell commands can be injected into the session<br/>
SyncAppvPublishingServer.exe has these same vulnerabilities!<br/>
<br/>
<img src="image 4.png"/><br/>
<br/>
Shows as &quot;SyncAppvPublishing&quot; in Autoruns<br/>
<br/>
Full PoC: cmd.exe /c cscript.exe SyncAppVPublishingServer.vbs &quot;.; Start-Process rundll32.exe 'shell32.dll,ShellExec_RunDLL calc.exe'&quot;<br/>
<br/>
Alt: cmd /c ScriptRunner.exe -appvscript SyncAppVPublishingServer.vbs &quot;.; Start-Process rundll32.exe 'shell32.dll,ShellExec_RunDLL calc.exe'&quot;<br/>
</body></html>