<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>General Primer</title>
</head><body>WARNING: NOT BUILT-IN BY DEFAULT. It's part of the Microsoft SDK. Signed by Microsoft. <br/>
<br/>
What is Vshadow?<br/>
Vshadow (vshadow.exe) is a command line utility for managing volume shadow copies. This tool is included within the Windows SDK and is signed by Microsoft (more on this later).<br/>
<br/>
Vshadow has a lot of functionality, including the ability to execute scripts and invoke commands in support of volume shadow snapshot management. Not surprisingly, these capabilities can be abused for privileged-level evasion, persistence, and file extraction.<br/>
<br/>
In this blog post, we will discuss Vshadow command execution, auto-start persistence, and sensitive file copy using Vshadow to extract the Active Directory (AD) database for offline hash dumping and password cracking.<br/>
<br/>
Conclusion<br/>
In addition to monitoring for the indicators above, defenders may want to keep an eye out for odd Volume Shadow Service (VSS) behavior such as random creations/deletions and any activity that involves the AD database file (ntds.dit). Also, monitor for command invocation of vshadow.exe switches. File hashes and names may change, but “-nw -exec=” and “-p -nw” will likely persist. </body></html>