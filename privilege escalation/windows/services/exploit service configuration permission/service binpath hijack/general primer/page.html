<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>General Primer</title>
</head><body>Sometimes services will run with SYSTEM or other user permissions<br/>
Sometimes these services allow any user to change the configuration of these services<br/>
Changing the BINARY_PATH_NAME / binpath or similar variable will allow for command execution as SYSTEM or other user<br/>
<br/>
This can be done one of two ways<ul><li>Service itself is configurable</li>
<li>Registry key related to service is configurable</li>
</ul>
<br/>
A popular service to enum is upnphost<br/>
<br/>
Metasploit module: exploit/windows/local/service_permissions<br/>
	1. Tries to create and start a service<br/>
	2. Attempts to change binpath of a service and restart<br/>
	3. See if binpath exe file's folder is writeable, create a new exe and restart the service<br/>
First, if the Meterpreter session is currently running under Administrator privileges, the module will aim to create and run a new service. If the current account privileges do not allow for service creation, the module will then seek out to determine if weak folder or file permissions will allow for hijacking existing services.<br/>
<br/>
When creating new services or hijacking existing ones, the module creates an executable, which has a randomly-generated filename as well as installation folder path. Enabling the AGGRESSIVE option on this module will exploit every vulnerable service on the target host. With the option disabled, the module stops at the first successful escalation attempt.</body></html>