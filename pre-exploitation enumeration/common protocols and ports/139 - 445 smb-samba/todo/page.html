<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>TODO</title>
</head><body># Fingerprint version<br/>
Kali&gt; smbclient -L //$TARGET<br/>
<br/>
# TODO<br/>
Kali&gt; nmblookup -A $TARGET<br/>
<br/>
# null Session<br/>
Kali&gt; rpcclient -v &quot;&quot; $TARGET<br/>
Kali&gt; smbclient -L //$TARGET<br/>
<br/>
# Minimal Scan<br/>
Kali&gt; enum4linux $TARGET<br/>
<br/>
# Scan Everything<br/>
Kali&gt; enum4linux -a $TARGET<br/>
<br/>
# discover windows/samba on subnet find macs and netbios name/domain<br/>
Kali&gt; nbtscan 192.168.1.0/24<br/>
<br/>
# Find open shares<br/>
Kali&gt; nmap -T4 -v -oA shares --script smb-enum-shares --script-args smbuser=username,smbpass=password -p445 192.168.1.0/24  <br/>
Kali&gt; Showmount -e $TARGET/&lt;port&gt;<br/>
<br/>
# Investigate share<br/>
Kali&gt; smblookup -A $TARGET smbclient //MOUNT/share -I $TARGET -N<br/>
<br/>
# Enumerate users<br/>
Kali&gt; nmap -sU -sS --script=smb-enum-users -p U:137,T:139 192.168.11.0/24<br/>
Kali&gt; python /usr/share/doc/python-impacket-doc/examples/samrdump.py $TARGET<br/>
<br/>
# RID Cycling (500 = admin, 501 = Guest)<br/>
Kali&gt; ridenum.py $TARGET 500 50000 /path/to/wordlist.txt<br/>
<br/>
# NBTScan-Unixwiz<br/>
Kali&gt; nbtscan-unixwiz -f $TARGET<br/>
<br/>
# Mount Linux/Windows<br/>
Kali&gt; mount $TARGET:/vol/share /mnt/nfs<br/>
Kali&gt; Mount -t cifs //&lt;server ip&gt;/&lt;share&gt; &lt;local dir&gt; -o username=”guest”,password=””<br/>
C:\&gt;net use Z: \\win-server\share password /user:domain\janedoe /savecred /p:no</body></html>