<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Post Exploitation Context</title>
</head><body>In a post-exploitation context, I think that MOF files can provide an original way to hide malicious code into the WMI repository. The possibilities are almost infinite because we can basically say: &quot;When _this_ event occurs, just do _that_ !&quot;. So, we can for example use MOF files with a backdoor or a rootkit in order to:<br/>
<ul><li>Automatically kill some processes as soon as they are launched (anti-rootkits...),</li>
<li>Automatically detect when the backdoor/rootkit has been deleted to load it again (dropper),</li>
<li>Automatically infect USB devices</li>
<li>...</li>
</ul>
<br/>
What is interesting here is that it shows how high level features provided by the System can be abused by an attacker. Classes hidden into WMI repository are not likely to be quickly detected because this technology is not so well-known by users and it is rarely checked.</body></html>