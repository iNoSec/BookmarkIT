<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>In-Memory</title>
</head><body>The concept behind in-memory dump of SAM hashes it to inject a DLL into the LSASS system process or, generally speaking, parsing the memory for specific patterns and inspect these memory pages' content. The former action can lead to a Blue Screen of Death (BSoD) condition following a crash of the LSASS process therefore this action is not recommended on production environments: prefer registry hive copy (regback.exe and reg.exe/regedit.exe) and Volume Shadow Copies techniques instead. Nevertheless, in some specific instances, the in-memory technique is required.<br/>
<br/>
The most widely known standalone tool to dump SAM hashes is probably <a href="http://www.foofus.net/~fizzgig/fgdump/">fgdump</a>, the successor of <a href="http://www.foofus.net/~fizzgig/pwdump/">pwdump6</a>, both tools developed by the <a href="http://www.foofus.net/">foofus</a>team. The main advantage of fgdump over pwdump6 is that it works on Windows Vista and later versions. Although, I have seen them both failing under some circumstances. More reliable tools include <a href="http://www.tarasco.org/security/pwdump_7/index.html">pwdump7</a>from Andres Tarasco and the <a href="http://www.truesec.se/sakerhet/verktyg/saakerhet/gsecdump_v2.0b5">gsecdump</a>from TrueSec. Both work on 32-bit and 64-bit systems across all versions of Windows. Although, the former cannot successfully dump users' password hashes on domain controllers as it reads the SAM hashes from the registry rather than injecting into LSASS process. Despite not working on 64-bit systems, another popular and reliable tool is PWDumpX by Reed Arvin.<br/>
<br/>
The Metasploit Framework also has its own post-exploitation modules, Meterpreter built-in command and dated Meterpreter script to dump the SAM hashes. Details on how these pieces of code work within the framework and which techniques they implement can be found on these blog posts by HD Moore.</body></html>