<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>General Primer</title>
</head><body>Linux privilege escalation can be divided into several sections of enumeration and trial and error. <br/>
<br/>
A large amount of enumeration can be required. Generally, the easy wins are considered:<br/>
Lax su or sudo permissions<br/>
Vulnerable kernel (unpatched/not up to date)<br/>
Lax PATH permissions<br/>
Lax file permissions<br/>
SUID / SGID binaries<br/>
<br/>
The potential for a user to have su or sudo powers without a password has been seen before. Not entirely common nowadays, but it takes two seconds to verify. Also worth another check if/when you discover a user password.<br/>
<br/>
When identifying software version vulnerabilities, be sure to search on several places for potential vulnerabilities <br/>
See &gt; Exploits and Advisories &gt; <a href="../../../exploits%20and%20advisories/exploits%20and%20advisories/page.html">Exploits and Advisories</a><br/>
<br/>
Generally, you'll need the ability to send files/exploits to and from the target machine. Look in the File Transfer section for potential ways to achieve this.<br/>
<br/>
<br/>
Having learned about and performed a lot of privilege escalation over recent months, there are several reasons I can think of that can make this especially difficult on Linux.<br/>
<br/>
1) Linux has always been designed as a multi-user operating system, which means that many features have been included over the years, to make privilege escalation more difficult (as well as secure default-configurations).<br/>
<br/>
2) There is a huge diversity of Linux distributions, and builds, so there are no &quot;one size fits all&quot; exes that you can just download and run.<br/>
<br/>
3) Many Linux Distributions have integrated application-updates (something which does not happen on Windows). This means that (if configured correctly) the operating system AND most of the applications will get updates automatically.<br/>
<br/>
4) Many Offsec students are from a Windows background, where privilege escalation is often not needed. This is either because ordinary user accounts are in the local Administrator group, or because there are many Windows remote-exploits which give direct System or Administrator access and do not require escalation.<br/>
<br/>
5) Linux configuration issues can sometimes be hard to spot, especially if you are not very familiar with Linux file-rights and access-control methods.<br/>
<br/>
<br/>
So, if you are learning how to perform privilege escalation on linux, you should expect it to be more difficult than Windows.<br/>
<br/>
Linux privilege escalation is difficult, it's supposed to be, but practice can make it easier.<br/>
<br/>
<br/>
Enumeration is key<br/>
Linux privilege escalation is all about:<br/>
<br/>
1) Enumeration, more enumeration, and more enumeration<br/>
2) Sorting through data, analysis and prioritisation<br/>
3) Knowing where to find exploit code<br/>
4) Customisation and compilation skills<br/>
5) Confidence that comes from lots of trial and error<br/>
<br/>
<br/>
Ideas; What information do you need to find?<br/>
Here is a list of some of the information an attacker would be looking to find in order to maximise their chances of successful privilege escalation on Linux.<br/>
(It's not comprehensive, but it is a good start)<br/>
<br/>
Enumeration of the operating system<br/>
What is the distribution type, and version?<br/>
What is the Kernel version?<br/>
<br/>
Enumeration of services and applications<br/>
What services are running, and in which user-context?<br/>
What are the versions of the running services?<br/>
What applications are installed, and what versions?<br/>
Do any of these services have vulnerable plugins or configurations.<br/>
What jobs are scheduled?<br/>
Pay particular attention to anything running as root<br/>
<br/>
Enumeration of the file-systems<br/>
What configuration files can be read/written in /etc/ ?<br/>
What information or content can be found in /var/ ?<br/>
Is it possible to write files to places that are in another users path?<br/>
Identify SUID and GUID files<br/>
Identify world-readable and world-writable files<br/>
How are file-systems mounted?<br/>
Are there any unmounted file-systems?<br/>
<br/>
Enumeration of confidential information<br/>
What sensitive files can be found?<br/>
Are there any passwords in; scripts, databases, configuration files or log files?<br/>
What user information can be found?<br/>
Can private-key information be found?<br/>
Examine files in user home directories (if possible)<br/>
<br/>
Enumeration of communications and networking<br/>
What NICs does the system have?<br/>
What are the network configuration settings?<br/>
What other hosts are communicating with the system?<br/>
Are there any cached IP or MAC addresses?<br/>
Is packet sniffing possible, and if so what can be seen?<br/>
Is SSH tunnelling possible?<br/>
<br/>
Preparation for exploit code<br/>
What development tools/languages are installed/supported?<br/>
What areas can be written to?<br/>
Where can code be executed?<br/>
How can files be uploaded?<br/>
<br/>
Finding exploit code<br/>
www.exploit-db.com<br/>
www.securityfocus.com<br/>
www.packetstormsecurity.org<br/>
www.google.com<br/>
<br/>
The only way to learn how to do privilege escalation is to practice, and keep trying.<br/>
Be good!<br/>
<br/>
<br/>
Mitigations<br/>
<br/>
From a defensive stance, you need to ask yourself very similar questions<br/>
Have you made any of the above information easy for an attacker to find?<br/>
Is the system fully patched? (Kernel, operating system, and all applications)<br/>
Are services running with the minimum level of privileges required?<br/>
Bastille Linux is a set of scripts that can be run to harden a Linux system<br/>
(checking for some of the above issues, and many more besides)</body></html>