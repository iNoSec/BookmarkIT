<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>x64 vs x32</title>
</head><body>Since $esp would be the lower 32 bits of the full stack pointer have you considered that with 64 bits you really probably want to be looking at what is pointed to by $rsp instead?<br/>
<br/>
By using $esp, you got the sign-extended 32-bit-truncated value of $rsp, which points to neverland.<br/>
Note: GDB provides <b>$sp pseudo-register that is automatically mapped to correct stack pointer register for a given platform</b>.<br/>
<br/>
(gdb) p $rsp<br/>
$1 = (void *) 0x7fffffffe178<br/>
(gdb) p $sp<br/>
$2 = (void *) 0x7fffffffe178<br/>
(gdb) p $esp<br/>
$3 = -7816<br/>
(gdb) p/x $esp<br/>
$4 = 0xffffe178</body></html>