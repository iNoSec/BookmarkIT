<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Links</title>
</head><body>WMI<br/>
<br/>
COM hijacking<br/>
<a href="https://attack.mitre.org/wiki/Technique/T1122">Component Object Model Hijacking - ATT&amp;CK</a><br/>
<a href="https://msdn.microsoft.com/library/ms694363.aspx">The Component Object Model</a><br/>
<a href="https://www.gdatasoftware.com/blog/2014/10/23941-com-object-hijacking-the-discreet-way-of-persistence">COM Object hijacking: the discreet way of persistence</a><br/>
<a href="https://enigma0x3.net/2016/05/25/userland-persistence-with-scheduled-tasks-and-com-handler-hijacking/">Userland Persistence with Scheduled Tasks and COM Handler Hijacking</a><br/>
<a href="https://www.slideshare.net/enigma0x3/windows-operating-system-archaeology">Windows Operating System Archaeology</a><br/>
&nbsp; <br/>
AppInit DLLs<br/>
<a href="https://support.microsoft.com/en-us/help/197571/working-with-the-appinit-dlls-registry-value">Working with the AppInit_DLLs registry value</a>&nbsp;| (<ul><li style="list-style-type: none">All the DLLs that are specified in this value are loaded by each Microsoft Windows-based application that is running in the current log on session.)</li>
</ul>
<a href="https://blog.didierstevens.com/2009/12/23/loaddllviaappinit/">LoadDLLViaAppInit - Didier Stevens</a>&nbsp;|<ul><li style="list-style-type: none">Selectively Load DLLs with AppInit</li>
</ul>
<a href="https://msdn.microsoft.com/en-us/library/dn280412">AppInit DLLs and Secure Boot</a><br/>
<br/>
Shims<br/>
<a href="https://technet.microsoft.com/en-us/library/dd837644(v=ws.10).aspx">Understanding Shims</a><br/>
<a href="http://www.alex-ionescu.com/?p=39">Secrets of the Application Compatilibity Database (SDB) – Part 1</a><br/>
<a href="http://www.alex-ionescu.com/?p=40">Secrets of the Application Compatilibity Database (SDB) – Part 2</a><br/>
<a href="http://www.alex-ionescu.com/?p=41">Secrets of the Application Compatilibity Database (SDB) – Part 3</a><br/>
<a href="http://www.alex-ionescu.com/?p=43">Secrets of the Application Compatilibity Database (SDB) – Part 4</a><br/>
<a href="https://www.blackhat.com/docs/eu-15/materials/eu-15-Pierce-Defending-Against-Malicious-Application-Compatibility-Shims-wp.pdf">Malicious Application Compatibility Shims</a><br/>
<a href="http://blacksunhackers.club/2016/08/post-exploitation-persistence-with-application-shims-intro/">Post Exploitation Persistence With Application Shims (Intro)</a><br/>
<a href="http://www.irongeek.com/i.php?page=videos/derbycon3/4206-windows-0wn3d-by-default-mark-baggett">Windows 0wn3d By Default - Mark Baggett - Derbycon 2013</a>&nbsp;|<ul><li>Description: “In this talk we will discuss API Hooking, Process Execution Redirection, Hiding Registry keys and hiding directories on the hard drive."</li>
</ul>
<a href="http://www.irongeek.com/i.php?page=videos/derbycon6/535-shackles-shims-and-shivs-understanding-bypass-techniques-mirovengi">Shackles, Shims, and Shivs - Understanding Bypass Techniques</a><br/>
<br/>
Logon Scripts<br/>
<a href="http://www.computerperformance.co.uk/Logon/logon_scripts.htm">Introduction Logon Scripts - With VBScript</a><br/>
<a href="http://loginscripts.com/">Login Scripts - Creating and Using Login Scripts</a><br/>
&nbsp;<br/>
Services <br/>
<a href="https://null-byte.wonderhowto.com/how-to/install-persistant-backdoor-windows-using-netcat-0162348/">Install a Persistant Backdoor in Windows Using Netcat</a><br/>
<a href="https://docs.microsoft.com/en-us/sql/integration-services/control-flow/script-task">Script Task</a>&nbsp;| <ul><li style="list-style-type: none">Persistence Via MSSQL</li>
</ul>
&nbsp;<br/>
Net Helper DLL<br/>
<a href="https://technet.microsoft.com/library/bb490939.aspx">Using Netsh</a><br/>
<a href="https://htmlpreview.github.io/?https://github.com/MatthewDemaske/blogbackup/blob/master/netshell.html">Netshell - Matthew Demaske</a><br/>
<a href="https://github.com/outflanknl/NetshHelperBeacon">NetshHelperBeacon - DLL to load from Windows NetShell. Will pop calc and execute shellcode.</a><br/>
&nbsp;<br/>
Office <br/>
<a href="https://support.office.com/en-us/article/Change-the-Normal-template-Normal-dotm-06de294b-d216-47f6-ab77-ccb5166f98ea?ui=en-US&rs=en-US&ad=US">Change the Normal template (Normal.dotm)</a>&nbsp;|<ul><li style="list-style-type: none">The Normal.dotm template opens whenever you start Microsoft Word, and it includes default styles and customizations that determine the basic look of a document.</li>
</ul>
<a href="https://msdn.microsoft.com/en-us/vba/office-shared-vba/articles/getting-started-with-vba-in-office">Getting Started with VBA in Office</a><br/>
<a href="https://enigma0x3.net/2014/01/23/maintaining-access-with-normal-dotm/comment-page-1/">Maintaining Access with Normal.dotm - enigma0x3</a><br/>
<a href="http://www.hexacorn.com/blog/2017/04/19/beyond-good-ol-run-key-part-62/">Beyond good ol’ Run key, Part 62 - Hexacorn</a>&nbsp;|<ul><li>Takeaway: Dropping any macro sheet inside the XLSTART folder and opening it from there will not show the macro warning</li>
</ul>
<a href="https://support.office.com/en-us/article/Add-or-remove-add-ins-0af570c4-5cf3-4fa9-9b88-403625a0b460?ui=en-US&rs=en-US&ad=US">Add or remove add-ins</a>&nbsp;|<ul><li>Add-ins provide optional commands and features for Microsoft Excel. By default, add-ins are not immediately available in Excel, so you must first install and (in some cases) activate these add-ins so that you can use them.</li>
</ul>
&nbsp;<br/>
Registry<br/>
<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa376977(v=vs.85).aspx">Run and RunOnce Registry Keys - MSDN</a>&nbsp;|<ul><li>Run and RunOnce registry keys cause programs to run each time that a user logs on.</li>
</ul>
<a href="http://www.hexacorn.com/blog/2017/01/28/beyond-good-ol-run-key-all-parts/">Beyond good ol’ Run key – All parts</a>&nbsp;| <ul><li>Here are the links to all the ‘Beyond good ol’ Run key’ posts so far.</li>
</ul>
<br/>
Security Support Provider <br/>
<a href="http://docplayer.net/20839173-Analysis-of-malicious-security-support-provider-dlls.html">Analysis of Malicious Security Support Provider DLLs</a><br/>
<a href="https://en.wikipedia.org/wiki/Security_Support_Provider_Interface">Security Support Provider Interface - Wikipedia</a><br/>
<a href="https://msdn.microsoft.com/en-us/library/bb742535.aspx">The Security Support Provider Interface - MSDN</a><br/>
&nbsp;<br/>
<br/>
Complete<br/>
https://github.com/huntresslabs/evading-autoruns<br/>
<a href="https://docs.microsoft.com/en-us/sysinternals/downloads/autoruns">Autoruns for Windows</a>&nbsp;&lt;- link to AutoRuns program<br/>
<a href="https://twitter.com/hasherezade/status/849756054145699840">Hasherezade Shell32.dll</a>&nbsp;&lt;- run32 shelldll<br/>
<a href="https://twitter.com/subTee/status/855738126882316288">Casey Smith SyncAppvPublishingServer</a><br/>
<a href="https://twitter.com/monoxgas/status/895417000410861568">Nick Landers SyncAppvPublishingServer on Win7</a><br/>
<a href="https://twitter.com/KyleHanslovan/status/905189665120149506">Kyle Hanslovan SyncAppvPublishingServer Nesting</a><br/>
https://bohops.com/2018/02/26/leveraging-inf-sct-fetch-execute-techniques-for-bypass-evasion-persistence/<br/>
https://bohops.com/2018/03/10/leveraging-inf-sct-fetch-execute-techniques-for-bypass-evasion-persistence-part-2/<br/>
<a href="https://github.com/mattifestation/WMI_Backdoor">https://github.com/mattifestation/WMI_Backdoor</a>&nbsp;<br/>
<a href="https://github.com/mattifestation/WMI_Backdoor">WMI_Backdoor</a>&nbsp;| A PoC WMI backdoor presented at Black Hat 2015<br/>
<a href="http://www.securitynewspaper.com/2015/10/10/abusing-windows-management-instrumentation-wmi-to-build-a-persistent-asynchronous-and-fileless-backdoor/">Abusing Windows Management Instrumentation (WMI) to Build a persistent, Asynchronous and Fileless Backdoor</a><br/>
<a href="https://web.archive.org/web/20170425164220/poppopret.blogspot.com/2011/09/playing-with-mof-files-on-windows-for.html">https://web.archive.org/web/20170425164220/poppopret.blogspot.com/2011/09/playing-with-mof-files-on-windows-for.html</a>&nbsp;| archive link for pictures<br/>
<a href="http://www.exploit-monday.com/2016/08/wmi-persistence-using-wmic.html">WMI Persistence using wmic.exe - exploit-monday</a><br/>
<a href="https://gist.github.com/mattifestation/e55843eef6c263608206">WMI_persistence_template.ps1</a>&nbsp;| Fileless WMI persistence payload template (CommandlineEventConsumer, __IntervalTimerInstruction trigger, w/ registry payload storage)<br/>
https://github.com/mattifestation/WMI_Backdoor/blob/master/Black_Hat_2015_Presentation/us15-Graeber-AbusingWindowsManagementInstrumentation.pdf <br/>
<a href="http://2014.hackitoergosum.org/slides/day1_WMI_Shell_Andrei_Dumitrescu.pdf">http://2014.hackitoergosum.org/slides/day1_WMI_Shell_Andrei_Dumitrescu.pdf</a>&nbsp;<br/>
https://pentestlab.blog/2017/11/20/command-and-control-wmi/<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
</body></html>