<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>ie4uinit</title>
</head><body>https://blogs.msdn.microsoft.com/askie/2012/09/13/things-to-do-when-troubleshooting-internet-explorer-terminal-server-and-profiles-issues/<br/>
<br/>
This blog post indicates that IE4Uinit is used in conjunction with Active Setup and runs when a user profile is created for the first time (or ‘fictitiously’ every time when mandatory profiles are configured) during the logon process. Additionally, several command switches were revealed that demonstrated usage<br/>
<br/>
<img src="image.png"/><br/>
<br/>
IE4uinit calls ieuinit.inf<br/>
<br/>
Instances of ieuinit.inf reside in the \System32 and \SysWOW64 directories. <br/>
This is interesting because such files cannot be edited without proper privileges (and some command line Kung Fu). However, this minor roadblock can be overcome based on a few interesting observations:<br/>
<br/>
A full/static path to ieuinit.inf does not exist (at least in the context of our Strings analysis). <br/>
	This means that we can call (‘side load’) an instance of ieuinit.inf as long as it is in the same directory as an instance of ie4uinit.exe.<br/>
	Even as an unprivileged user, we can simply copy these files out of the \System32 directory, make desired INF file edits in a user writable directory, and test for SCT payload execution.<br/>
<br/>
Let’s copy these files into a working directory and update the INF file accordingly:<br/>
	copy &quot;C:\Windows\System32\ie4uinit.exe&quot; &quot;C:\test\&quot;<br/>
	copy &quot;C:\Windows\System32\ieuinit.inf&quot; &quot;C:\test\&quot;<br/>
<br/>
In this use case, the lead-in INF directive calls a section labeled DefaultInstall.Windows7, which initiates MSIE4RegisterOCX.Windows7. This is where we add our scrobj.dll/SCT URL payload<br/>
<br/>
<img src="image 2.png"/><br/>
<br/>
&quot;Properly&quot; execute the payload with:<br/>
ie4uinit.exe -BaseSettings<br/>
<br/>
**Note: During the course of testing across platforms, I’ve noticed an interesting problem on one of my machines where I could not invoke the script within the MSIE4RegisterOCX.Windows7 section. After adding a new section (FunRun) with our scrobj.dll/SCT entry, I modified the DefaultInstall.Windows7 section with the addition of UnregisterOCXs to point to the FunRun section. The end-to-end invocation was successful. This may prove helpful if anyone has problems when trying to test this method. Root cause of this problem has not been determined</body></html>